# 関数

## 関数の定義

関数は ```function``` と ```end``` で囲んで定義します。以下が基本形です。

```Julia
function func(args...)
    ...
    return ret
end
```

戻り値は ```return``` で返します。関数の途中に ```return``` がある場合はその後から関数末尾までの処理は実行されません。

以下は2つの引数の和を返す関数の例です。

```Julia
julia> function add(x,y)
           return x + y
       end
add (generic function with 1 method)

julia> add(2,3)
5
```

なお、```return``` を省略すると最後に評価された式の値が返ります。従って、上の関数は以下のように記述することも可能です。

```Julia
julia> function add(x,y)
           x + y
       end
add (generic function with 1 method)
```

また、上記のような一行で記述できるような関数であれば、簡略化した以下のような代入形式（assignment form）を利用することもできます。

```Julia
julia> add(x,y) = x + y
add (generic function with 1 method)
```

## 関数の参照

前節で見てきたように、関数の呼び出しは以下のような形で行います。

```Julia
func(args...)
```

関数は他の変数と同様、オブジェクトの一つです。従って、関数そのものを代入したり、それを利用して関数を呼び出したりすることもできます。

```Julia
julia> f = add
add (generic function with 1 method)

julia> f(5,7)
12
```

## 無名関数

名前のない関数、いわゆる無名関数（anonymous function）を定義することもできます。

```Julia
julia> x -> x - 273.15
#1 (generic function with 1 method)

julia> (x, y) -> x + 2y - 1
#3 (generic function with 1 method)
```

この例のように、引数が1個しかない場合は左辺の括弧を省略できます。ちなみに #1 は、コンパイラが内部的につけている関数名です。

無名関数は、```function``` 文において関数名を省略することでも定義できます。

```Julia
julia> function (x)
           x - 273.15
       end
#1 (generic function with 1 method)
```

無名関数の利用場面としては、関数への引数として関数を渡す状況（コールバック）が考えられます。コールバックによって関数の汎用性が高まるとともに、無名関数を指定することで名前の無用な重複を気にする必要がなくなります。

```Julia
julia> function calc4( f, v )
           f(v)^4
       end
       calc2(x -> x + 273.15, 10)
80173.92249999999
```

もう少し実用的な例としては、```map()``` 関数における活用例があります。```map()``` は関数と引数配列を与えると、戻り値を配列で返す関数です。

```Julia
julia> map( x -> x + 273.15, [10.0, 15.5, 22.3] )
3-element Vector{Float64}:
 283.15
 288.65
 295.45
```
